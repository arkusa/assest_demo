{"version":3,"sources":["router/r1.js","router/r2.js","router/r3.js","keepAlive/index.js","index.js"],"names":["R1","props","state","count","click","setState","console","log","style","textAlign","this","onClick","React","Component","R2","R3","NOOP","KeepAlive","init","initChildDidMount","object","instances","key","instanceKey","didMount","children","type","prototype","componentDidMount","__is_keep_active__","argvs","call","Object","getPrototypeOf","componentWillUnmount","componentActived","componentDeactived","instance","KeepAliveWrap","ins","window","ReactDOM","render","path","width","height","display","justifyContent","margin","to","document","getElementById"],"mappings":"4NAGqBA,E,kDAKnB,WAAYC,GAAQ,IAAD,8BACjB,cAAMA,IALRC,MAAQ,CACNC,MAAO,GAGU,EA8BnBC,MAAQ,WACN,EAAKC,UAAS,SAACH,GAAD,mBAAC,eACVA,GADS,IAEZC,MAAOD,EAAMC,MAAQ,QA/BvBG,QAAQC,IAAI,kBAFK,E,gEAWjBD,QAAQC,IAAI,iB,yCAIZD,QAAQC,IAAI,gB,2CAIZD,QAAQC,IAAI,kB,6CAIZD,QAAQC,IAAI,gB,4CAIZD,QAAQC,IAAI,a,+BAWZ,OACE,qCACE,oBAAIC,MAAO,CAAEC,UAAW,UAAxB,gBACA,8BAAOC,KAAKR,MAAMC,OAAS,IAC3B,wBAAQQ,QAASD,KAAKN,MAAtB,gC,kDAnCJ,OADAE,QAAQC,IAAI,6BACL,S,GAZqBK,IAAMC,WCDjBC,E,4MACnBZ,MAAQ,CACNC,MAAO,G,EAmBTC,MAAQ,WACN,EAAKC,UAAS,SAACH,GAAD,mBAAC,eACVA,GADS,IAEZC,MAAOD,EAAMC,MAAQ,Q,kEAlBvBG,QAAQC,IAAI,iB,yCAIZD,QAAQC,IAAI,gB,2CAIZD,QAAQC,IAAI,kB,6CAIZD,QAAQC,IAAI,gB,+BAYZ,OACE,qCACE,oBAAIC,MAAO,CAAEC,UAAW,UAAxB,gBACA,8BAAOC,KAAKR,MAAMC,OAAS,IAC3B,wBAAQQ,QAASD,KAAKN,MAAtB,iC,GAlCwBQ,IAAMC,WCAjBE,E,4MACnBb,MAAQ,CACNC,MAAO,G,EAeTC,MAAQ,WACN,EAAKC,UAAS,SAACH,GAAD,mBAAC,eACVA,GADS,IAEZC,MAAOD,EAAMC,MAAQ,Q,kEAdvBG,QAAQC,IAAI,iB,yCAIZD,QAAQC,IAAI,gB,2CAIZD,QAAQC,IAAI,kB,+BAYZ,OACE,qCACE,oBAAIC,MAAO,CAAEC,UAAW,UAAxB,gBACA,8BAAOC,KAAKR,MAAMC,OAAS,IAC3B,wBAAQQ,QAASD,KAAKN,MAAtB,iC,GA9BwBQ,IAAMC,W,QCAhCG,EAAO,aAMQC,E,kDAEnB,WAAYhB,GAAQ,IAAD,8BACjB,cAAMA,IACDiB,OAFY,E,mDAMjBR,KAAKS,sB,0CAIL,IAAMC,EAASV,KAAKT,MAAMoB,UACpBC,EAAMZ,KAAKT,MAAMsB,YAEvB,IAAIH,EAAOE,GAAX,CAEA,IAAME,EAAWd,KAAKT,MAAMwB,SACzBC,KAAKC,UAAUC,mBAAqBZ,EAEvCN,KAAKT,MAAMwB,SACRC,KAAKC,UAAUC,kBAAoB,WAClCR,EAAOE,GAAOZ,KACdU,EAAOE,GAAKO,oBAAqB,EAFoB,2BAAPC,EAAO,yBAAPA,EAAO,gBAIrDN,EAASO,KAAT,MAAAP,EAAQ,CAAMd,MAAN,OAAeoB,IAEvBE,OAAOC,eAAevB,MAAMkB,kBACxBJ,M,0CAKR,IAAMJ,EAASV,KAAKT,MAAMoB,UACpBC,EAAMZ,KAAKT,MAAMsB,YAQvB,GANAjB,QAAQC,IAAIa,EAAOE,IACfF,EAAOE,KACTF,EAAOE,GAAKM,kBAAoB,aAChCR,EAAOE,GAAKY,qBAAuB,cAInCd,EAAOE,IACoC,oBAAjCF,EAAOE,GAAKa,iBAEtB,OAAOf,EAAOE,GAAKa,qB,6CAKrB,IAAMf,EAASV,KAAKT,MAAMoB,UACpBC,EAAMZ,KAAKT,MAAMsB,YAEvB,GACEH,EAAOE,IACsC,oBAAnCF,EAAOE,GAAKc,mBAEtB,OAAOhB,EAAOE,GAAKc,uB,+BAKrB,IAgBiBC,EAhBXjB,EAASV,KAAKT,MAAMoB,UACpBC,EAAMZ,KAAKT,MAAMsB,YAEvB,GAAGH,EAAOE,GAAM,CACd,IAAMgB,GAYSD,EAZmBjB,EAAOE,GAa7C,YACE,aAAe,IAAD,EACZ,OADY,oBACL,cAAAe,GAFX,uCAAO,EAAP,CAAqBzB,IAAMC,YAZvB,OACE,cAACyB,EAAD,IAIJ,OACE5B,KAAKT,MAAMwB,a,GA1EsBb,IAAMC,WCE7C,IAAM0B,EAAM,GAEZC,OAAOD,IAAMA,EACbE,IAASC,OACP,eAAC,IAAD,WACE,gCACE,yHAEA,4GAEA,0GAEA,4FAEF,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,KAAK,KAAZ,SACE,cAAC,EAAD,CAEEtB,UAAWkB,EACXhB,YAAY,IAHd,SAKE,cAAC,EAAD,KAJI,OAOR,cAAC,IAAD,CAAOoB,KAAK,KAAZ,SACE,cAAC,EAAD,CAEEtB,UAAWkB,EACXhB,YAAY,IAHd,SAKE,cAAC,EAAD,KAJI,OAOR,cAAC,IAAD,CAAOoB,KAAK,KAAZ,SACE,cAAC,EAAD,CAEEtB,UAAWkB,EACXhB,YAAY,IAHd,SAKE,cAAC,EAAD,KAJI,OASR,cAAC,IAAD,CAAOoB,KAAK,KAAZ,SACE,cAAC,EAAD,MAEF,cAAC,IAAD,CAAOA,KAAK,KAAZ,SACE,cAAC,EAAD,MAEF,cAAC,IAAD,CAAOA,KAAK,KAAZ,SACE,cAAC,EAAD,SAIJ,sBAAKnC,MAAO,CAAEoC,MAAO,QAASC,OAAQ,QAASC,QAAS,OAAQC,eAAgB,eAAgBC,OAAQ,QAAxG,UACE,cAAC,IAAD,CAAMC,GAAG,KAAT,gBACA,cAAC,IAAD,CAAMA,GAAG,KAAT,gBACA,cAAC,IAAD,CAAMA,GAAG,KAAT,gBACA,cAAC,IAAD,CAAMA,GAAG,KAAT,gBACA,cAAC,IAAD,CAAMA,GAAG,KAAT,gBACA,cAAC,IAAD,CAAMA,GAAG,KAAT,sBAGHC,SAASC,eAAe,W","file":"static/js/main.7749a388.chunk.js","sourcesContent":["/* eslint-disable */\nimport React from 'react';\n\nexport default class R1 extends React.Component {\n  state = {\n    count: 1,\n  }\n  \n  constructor(props) {\n    super(props);\n    console.log('r1 constructor');\n  }\n\n  static getDerivedStateFromProps() {\n    console.log('r1 derivedStateFrom Props');\n    return null;\n  }\n\n  componentDidMount() {\n    console.log('r1 DidMount');\n  }\n\n  componentActived() {\n    console.log('r1 Actived');\n  }\n\n  componentDeactived() {\n    console.log('r1 Deactived');\n  }\n\n  componentWillUnmount() {\n    console.log('r1 unmount');\n  }\n\n  componentDidUpdated() {\n    console.log('updated');\n  }\n\n  click = () => {\n    this.setState((state) => ({\n      ...state,\n      count: state.count + 1\n    }));\n  }\n\n  render() {\n    return (\n      <>\n        <h2 style={{ textAlign: 'center' }}>R1</h2>\n        <div>{ this.state.count || 0 }</div>\n        <button onClick={this.click}>点击</button>\n      </>\n    );\n  }\n}\n","import React from 'react';\n\nexport default class R2 extends React.Component {\n  state = {\n    count: 2,\n  }\n\n  componentDidMount() {\n    console.log('r2 DidMount');\n  }\n\n  componentActived() {\n    console.log('r2 Actived');\n  }\n\n  componentDeactived() {\n    console.log('r2 Deactived');\n  }\n\n  componentWillUnmount() {\n    console.log('r2 unmount');\n  }\n\n  click = () => {\n    this.setState((state) => ({\n      ...state,\n      count: state.count + 1\n    }));\n  }\n\n  render() {\n\n    return (\n      <>\n        <h2 style={{ textAlign: 'center' }}>R2</h2>\n        <div>{ this.state.count || 0 }</div>\n        <button onClick={this.click}>点击</button>\n      </>\n    );\n  }\n}\n\n","import React from 'react';\n\nexport default class R3 extends React.Component {\n  state = {\n    count: 3,\n  }\n\n  componentDidMount() {\n    console.log('r3 DidMount');\n  }\n\n  componentActived() {\n    console.log('r3 Actived');\n  }\n\n  componentDeactived() {\n    console.log('r3 Deactived');\n  }\n\n  click = () => {\n    this.setState((state) => ({\n      ...state,\n      count: state.count + 1\n    }));\n  }\n\n  render() {\n\n    return (\n      <>\n        <h2 style={{ textAlign: 'center' }}>R3</h2>\n        <div>{ this.state.count || 0 }</div>\n        <button onClick={this.click}>点击</button>\n      </>\n    );\n  }\n}\n\n\n","import React from 'react';\n\nconst NOOP = () => {};\n/*\n * @param {props.instances} - keepAlive 保存的实例集合\n * @param {props.key} - 必须，且不能重复，这是为了每次路由变化的时候强制KeepAlive更新\n * @param {props.instanceKey} - instances 中的key值, 组件实例被保存到instances[instanceKey]\n */\nexport default class KeepAlive extends React.Component {\n  \n  constructor(props) {\n    super(props);\n    this.init();\n  }\n\n  init() {\n    this.initChildDidMount();\n  }\n\n  initChildDidMount() {\n    const object = this.props.instances;\n    const key = this.props.instanceKey;\n\n    if (object[key]) return;\n\n    const didMount = this.props.children\n      .type.prototype.componentDidMount || NOOP;\n\n    this.props.children\n      .type.prototype.componentDidMount = function(...argvs) {\n        object[key] = this;\n        object[key].__is_keep_active__ = true;\n\n        didMount.call(this, ...argvs);\n        \n        Object.getPrototypeOf(this).componentDidMount\n          = didMount\n      }\n  }\n\n  componentDidMount() {\n    const object = this.props.instances;\n    const key = this.props.instanceKey;\n\n    console.log(object[key]);\n    if (object[key]) {\n      object[key].componentDidMount = () => {};\n      object[key].componentWillUnmount = () => {};\n    }\n\n    if(\n      object[key]\n      && typeof object[key].componentActived === 'function'\n    ) {\n      return object[key].componentActived();\n    }\n  }\n\n  componentWillUnmount() {\n    const object = this.props.instances;\n    const key = this.props.instanceKey;\n\n    if(\n      object[key]\n      && typeof object[key].componentDeactived === 'function'\n    ) {\n      return object[key].componentDeactived();\n    }\n  }\n\n  render() {\n    const object = this.props.instances;\n    const key = this.props.instanceKey;\n\n    if(object[key]) {\n      const KeepAliveWrap = WrapFactory(object[key]);\n      return (\n        <KeepAliveWrap />\n      );\n    }\n\n    return (\n      this.props.children\n    );\n  }\n}\n\nfunction WrapFactory(instance) {\n  return class extends React.Component {\n    constructor() {\n      return instance;\n    }\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n// import App from './App';\nimport { HashRouter as BrowserRouter, Route, Switch, Link } from 'react-router-dom';\n\nimport R1 from './router/r1';\nimport R2 from './router/r2';\nimport R3 from './router/r3';\nimport KeepAlive from './keepAlive';\n\nconst ins = {};\n\nwindow.ins = ins;\nReactDOM.render((\n  <BrowserRouter>\n    <pre>\n      <h2>R* 组件自身维护了一个 状态 this.state.count</h2>\n\n      <h2>下面的按钮可以让状态自增 1</h2>\n\n      <h2>相互切换看状态是否被保留</h2>\n\n      <h2>R 4 - 6 是 R 1 - 3的非KeepAlive模式</h2>\n    </pre>\n    <Switch>\n      <Route path=\"/1\">\n        <KeepAlive\n          key=\"1\"\n          instances={ins}\n          instanceKey=\"1\"\n        >\n          <R1 />\n        </KeepAlive>\n      </Route>\n      <Route path=\"/2\">\n        <KeepAlive\n          key=\"2\"\n          instances={ins}\n          instanceKey=\"2\"\n        >\n          <R2 />\n        </KeepAlive>\n      </Route>\n      <Route path=\"/3\">\n        <KeepAlive\n          key=\"3\"\n          instances={ins}\n          instanceKey=\"3\"\n        >\n          <R3 />\n        </KeepAlive>\n      </Route>\n\n\n      <Route path=\"/4\">\n        <R1 />\n      </Route>\n      <Route path=\"/5\">\n        <R2 />\n      </Route>\n      <Route path=\"/6\">\n        <R3 />\n      </Route>\n    </Switch>\n\n    <div style={{ width: '200px', height: '100px', display: 'flex', justifyContent: 'space-around', margin: 'auto' }}>\n      <Link to=\"/1\">R1</Link>\n      <Link to=\"/2\">R2</Link>\n      <Link to=\"/3\">R3</Link>\n      <Link to=\"/4\">R4</Link>\n      <Link to=\"/5\">R5</Link>\n      <Link to=\"/6\">R6</Link>\n    </div>\n  </BrowserRouter>\n), document.getElementById('root'));\n\n"],"sourceRoot":""}